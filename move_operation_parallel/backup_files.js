import 'dotenv/config';
import { 
    S3Client, 
    ListObjectsV2Command, 
    CopyObjectCommand, 
    DeleteObjectCommand 
} from "@aws-sdk/client-s3";


// Create an S3 client
const s3Client = new S3Client({
    region: "us-east-1",
    credentials: {
      accessKeyId: process.env?.accessKeyId,
      secretAccessKey: process.env?.secretAccessKey,
    },
  });


/**
 * Moves a single S3 object by copying it to a new key and deleting the original.
 * @param {string} bucket - The S3 bucket name.
 * @param {string} sourceKey - The original key of the object.
 * @param {string} destinationKey - The new key for the object.
 * @returns {Promise<void>}
 */
async function moveObject(backupBucket, sourceBucket, sourceKey, destinationKey) {
    // Copy the object to the new location
    // const copyParams = {
    //     Bucket: backupBucket,
    //     CopySource: `${sourceBucket}/${sourceKey}`,
    //     Key: destinationKey,
    // };
    // await s3Client.send(new CopyObjectCommand(copyParams));

    // Delete the original object
    // const deleteParams = {
    //     Bucket: sourceBucket,
    //     Key: sourceKey,
    // };
    // await s3Client.send(new DeleteObjectCommand(deleteParams));
}

let startTime = Date.now();
let sourceBucket = "110ec58a-a0f2-4ac4-8393-c866d813b8d8-000";
let backupBucket = "110ec58a-a0f2-4ac4-8393-c866d813b8d8";
let sourcePrefixList =  [
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot0_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot100_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot101_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot102_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot103_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot104_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot105_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot106_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot107_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot108_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot109_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot10_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot110_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot111_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot112_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot113_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot114_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot115_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot116_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot117_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot118_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot119_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot11_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot120_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot121_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot122_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot123_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot124_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot125_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot126_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot127_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot128_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot129_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot12_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot130_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot131_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot132_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot133_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot134_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot135_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot136_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot137_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot138_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot139_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot13_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot140_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot141_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot142_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot143_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot144_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot145_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot146_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot147_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot148_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot149_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot14_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot150_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot151_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot152_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot153_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot154_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot155_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot156_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot157_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot158_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot159_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot15_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot160_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot161_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot162_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot163_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot164_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot165_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot166_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot167_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot168_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot169_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot16_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot170_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot171_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot172_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot173_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot174_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot175_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot176_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot177_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot178_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot179_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot17_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot180_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot181_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot182_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot183_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot184_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot185_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot186_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot187_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot188_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot189_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot18_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot190_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot191_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot192_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot193_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot194_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot195_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot196_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot197_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot198_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot199_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot19_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot1_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot200_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot201_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot202_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot203_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot204_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot205_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot206_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot207_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot208_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot209_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot20_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot210_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot211_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot212_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot213_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot214_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot215_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot216_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot217_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot218_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot219_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot21_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot220_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot221_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot222_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot223_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot224_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot225_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot226_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot227_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot228_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot229_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot22_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot230_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot231_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot232_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot233_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot234_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot235_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot236_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot237_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot238_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot239_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot23_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot240_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot241_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot242_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot243_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot244_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot245_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot246_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot247_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot248_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot249_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot24_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot250_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot251_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot252_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot253_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot254_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot255_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot256_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot257_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot258_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot259_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot25_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot260_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot261_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot262_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot263_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot264_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot265_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot266_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot267_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot268_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot269_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot26_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot270_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot271_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot272_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot273_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot274_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot275_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot276_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot277_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot278_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot279_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot27_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot280_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot281_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot282_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot283_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot284_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot285_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot286_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot287_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot288_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot289_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot28_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot290_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot291_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot292_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot293_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot294_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot295_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot296_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot297_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot298_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot299_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot29_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot2_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot300_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot301_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot302_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot303_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot304_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot305_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot306_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot307_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot308_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot309_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot30_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot310_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot311_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot312_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot313_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot314_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot315_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot316_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot317_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot318_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot319_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot31_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot320_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot321_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot322_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot323_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot324_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot325_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot326_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot327_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot32_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot33_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot34_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot35_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot36_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot37_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot38_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot39_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot3_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot40_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot41_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot42_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot43_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot44_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot45_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot46_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot47_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot48_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot49_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot4_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot50_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot51_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot52_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot53_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot54_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot55_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot56_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot57_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot58_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot59_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot5_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot60_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot61_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot62_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot63_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot64_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot65_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot66_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot67_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot68_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot69_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot6_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot70_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot71_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot72_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot73_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot74_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot75_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot76_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot77_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot78_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot79_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot7_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot80_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot81_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot82_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot83_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot84_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot85_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot86_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot87_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot88_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot89_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot8_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot90_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot91_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot92_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot93_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot94_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot95_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot96_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot97_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot98_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot99_status/ROOT.completed",
    "1752642633718/JITDeltaOAD/1749166725994/00A02_C/csivMergerPerRangeSubRoot9_status/ROOT.completed"
  ]
let backupPrefix = "CSIVMergerFilesBackup/csivMergerPerRangeSubRootFiles/";
let region = "us-east-1";

const movePromises = sourcePrefixList.map(sourcePrefix => {
    // Remove the source prefix from the key to get the base name
    const baseKey = sourcePrefix.substring(sourcePrefix.length);
    const destinationKey = `${backupPrefix}${sourcePrefix}`;
    
    return moveObject(backupBucket,sourceBucket, sourcePrefix, destinationKey)
        .then(() => ({ status: 'fulfilled', value: `Moved ${sourcePrefix} to ${destinationKey}` }))
        .catch(err => ({ status: 'rejected', reason: `Failed to move ${sourcePrefix}: ${err.message}` }));
});

// 3. Execute all promises in parallel
console.log(`Starting parallel move for ${movePromises.length} objects...`);
const results = await Promise.allSettled(movePromises);

 // 4. Report the results
 let successCount = 0;
 let failureCount = 0;

 results.forEach(result => {
     if (result.status === 'fulfilled') {
         // console.log(result.value); // Uncomment for verbose success logging
         successCount++;
     } else {
         console.error(result.reason);
         failureCount++;
     }
 });

 console.log("\n--- Move Operation Complete ---");
 console.log(`Successfully moved: ${successCount} objects.`);
 console.log(`Failed to move:   ${failureCount} objects.`);
 let endTime = Date.now();
 console.log(`Total time taken: ${endTime - startTime} ms`);
 console.log("-----------------------------");
